# MySQL 아키텍처
<br>

-----------------------
### MySQL에서 사용되는 메모리 공간은 크게 어떻게 구분할 수 있는가?

<details>
   <summary> 답안 보기 (👈 Click)</summary>
  
<br />

+ 글로벌 메모리 영역과 로컬 메모리 영역으로 구분할 수 있습니다. 

</details>

-----------------------

### MySQL 메모리 공간의 글로벌 메모리 영역은 어떤 특징을 갖고 있고, 무엇으로 구성되는가?

<details>
   <summary> 답안 보기 (👈 Click)</summary>
<br />

+ 글로벌 메모리 영역은 일반적으로 스레드의 수와 무관하게 하나의 메모리 공간만 할당됩니다. <br> 
  대표적인 글로벌 메모리 영역은 테이블 캐시, InnoDB 버퍼 풀, InnoDB 어댑티브 해시 인덱스, InnoDB 리두 로그 버퍼가 있습니다. 

</details>

-----------------------

### MySQL 메모리 공간의 로컬 메모리 영역은 어떤 특징을 갖고 있고, 무엇으로 구성되는가?

<details>
   <summary> 답안 보기 (👈 Click)</summary>
<br />

+ 로컬 메모리 영역은 각 클라이언트 스레드별로 독립적으로 할당되며, 절대 공유되어 사용되지 않는다는 특징이 있습니다. <br> 
  대표적인 로컬 메모리 영역은 정렬 버퍼, 조인 버퍼, 바이너리 로그 캐시, 네트워크 버퍼 등이 있습니다.  

</details>

-----------------------

### MySQL 엔진의 쿼리 실행 구조는 어떻게 되나요?

<details>
   <summary> 답안 보기 (👈 Click)</summary>
<br />

+ 쿼리 파서, 전처리기, 옵티마이저, 실행 엔진 등으로 구성됩니다. 

</details>

-----------------------


### 쿼리 파서란 무엇인가요?

<details>
   <summary> 답안 보기 (👈 Click)</summary>
<br />

+ 쿼리 파서란 사용자 요청으로 들어온 쿼리 문장을 토큰으로 분리해 트리 형태의 구조로 만들어내는 작업을 의미합니다. <br> 

</details>

-----------------------


### 전처리기란 무엇인가요?

<details>
   <summary> 답안 보기 (👈 Click)</summary>
<br />

+  <br> 

</details>

-----------------------


### 옵티마이저란 무엇인가요?

<details>
   <summary> 답안 보기 (👈 Click)</summary>
<br />

+  <br> 

</details>

-----------------------

### MVCC란 무엇입니까? 

<details>
   <summary> 답안 보기 (👈 Click)</summary>
<br />

+ 일반적으로 레코드 레벨의 트랜잭션을 지원하는 DBMS가 제공하는 기능이며, <br>
  MVCC의 가장 큰 목적은 잠금을 사용하지 않는 일관된 읽기를 제공하는데 있습니다. <br>
  InnoDB는 언두 로그를 이용해 이 기능을 구현합니다. <br> 
  여기서 멀티 버전이라 함은 하나의 레코드에 대해 여러 개의 버전이 동시에 관리된다는 의미입니다. <br>
   

</details>

-----------------------

### MVCC가 어떻게 동작하는지를 격리 수준에 따라 예시를 들어서 설명해주세요

<details>
   <summary> 답안 보기 (👈 Click)</summary>
<br />

+ UPDATE 쿼리가 실행되면, 커밋 여부와 상관 없이 새로운 값이 InnoDB 버퍼 풀에 업데이트 되고, <br>
  기존 값은 언두 로그에 복사됩니다. <br>  
  트랜잭션 격리 수준이 READ UNCOMMITTED인 경우는, InnoDB 버퍼 풀의 데이터를 반환하고, <br> 
  READ COMMITTED나 그 이상의 격리 수준인 경우는 아직 커밋되지 않았기 때문에, <br>  
  언두 로그의 값을 반환합니다.  
   
</details>

-----------------------

### 잠금 없는 일관된 읽기란 무엇인가요? 

<details>
   <summary> 답안 보기 (👈 Click)</summary>
<br />

+ InnoDB 스토리지 엔진은 MVCC 기술을 이용해 잠금을 걸지 않고 읽기 작업을 수행합니다. <br>
  이를 잠금 없는 일관된 읽기라고 합니다. 
   
</details>

-----------------------

### 언두 로그란 무엇인가요? 

<details>
   <summary> 답안 보기 (👈 Click)</summary>
<br />

+ InnoDB 스토리지 엔진은 트랜잭션 격리 수준을 보장하기 위해 DML(INSERT, UPDATE, DELETE)로 변경되기 이전 버전의<br>
  데이터를 별도로 백업합니다. <br>
  이렇게 백업된 데이터를 언두 로그(Undo log)라고 합니다.  
   
</details>

-----------------------


### 언두 로그의 두 가지 기능은 무엇인가요? 

<details>
   <summary> 답안 보기 (👈 Click)</summary>
<br />

+ 언두 로그의 2가지 기능은 트랜잭션 보장과 격리 수준 보장입니다. <br>
  우선 트랜잭션 보장이란, 트랜잭션이 롤백되면 트랜잭션 도중 변경된 데이터를 변경 전 데이터로 복구해야 하는데, <br>
  이 때, 언두 로그에 백업해둔 이전 버전의 데이터를 이용해 복구합니다. <br>
  격리 수준 보장이란, 특정 커넥션에서 데이터를 변경하는 도중에 다른 커넥션에서 데이터를 조회하면 <br>
  트랜잭션 격리 수준에 맞게 변경 중인 레코드를 읽지 않고 언두 로그에 백업해둔 데이터를 읽어서 반환합니다.  
   
</details>

-----------------------


### InnoDB 버퍼 풀이란 무엇입니까?

<details>
   <summary> 답안 보기 (👈 Click)</summary>
<br />

+ InnoDB 스토리지 엔진에서 가장 핵심적인 부분으로, 디스크의 데이터 파일이나 인덱스 정보를 메모리에 캐시해 두는 공간입니다. <br>
  쓰기 작업을 지연시켜 일괄 작업으로 처리할 수 있게 해주는 버퍼 역할도 같이 합니다. <br> 

</details>

-----------------------

### 왜 버퍼 풀이 버퍼 역할을 함으로써 성능이 향상됩니까?

<details>
   <summary> 답안 보기 (👈 Click)</summary>
<br />

+ 일반적인 애플리케이션에서는INSERT, UPDATE, DELETE 처럼 데이터를 변경하는 쿼리는 데이터 파일의 이곳저곳에 위치한 레코드를 변경하기 때문에, <br>
  랜덤 디스크 I/O를 발생시킵니다. 하지만 버퍼 풀이 이러한 변경된 데이터를 모아서 처리하면 랜덤 디스크 I/O를 줄일 수 있습니다.  

</details>

-----------------------

### InnoDB 버퍼 풀의 크기는 어떻게 설정해야 하는가?

<details>
   <summary> 답안 보기 (👈 Click)</summary>
<br />

+ 운영체제의 전체 메모리 공간이 8GB 미만이라면 50% 정도만 InnoDB 버퍼 풀로 설정하고, <br>
  전체 메모리 공간이 그 이상이라면 InnoDB 버퍼 풀의 크기를 전체 메모리의 50%에서 시작해서 조금씩 올려가면서 <br>
  최적점을 찾습니다. 
  
</details>

-----------------------

### InnoDB 버퍼 풀의 구조는 어떠합니까?

<details>
   <summary> 답안 보기 (👈 Click)</summary>
<br />

+ InnoDB 스토리지 엔진은 버퍼 풀이라는 거대한 메모리 공간을 페이지 크기의 조각으로 쪼개어 <br>
  InnoDB 스토리지 엔진이 데이터를 필요로 할 때, 해당 데이터 페이지를 읽어서 각 조각에 저장합니다. <br>
 
</details>

-----------------------

### InnoDB 버퍼 풀의 페이지 크기 조각을 관리하기 위한 3가지 자료구조는 무엇입니까?

<details>
   <summary> 답안 보기 (👈 Click)</summary>
<br />

+ LRU 리스트와 플러시 리스트, 그리고 프리 리스트입니다. <br>
  LRU 리스트는 엄밀하게 LRU와 MRU가 결합된 형태입니다. 
 
</details>

-----------------------

### LRU 리스트를 관리하는 목적은 무엇입니까?

<details>
   <summary> 답안 보기 (👈 Click)</summary>
<br />

+ 한 번 읽어온 페이지를 최대한 오랫동안 InnoDB 버퍼 풀의 메모리에 유지해서 <br>
  디스크 읽기를 최소화하는 것입니다. <br>
  
</details>

-----------------------

### InnoDB 스토리지 엔진에서 데이터를 찾는 과정은 어떻습니까?

<details>
   <summary> 답안 보기 (👈 Click)</summary>
<br />

+ 
  
</details>

-----------------------

### 리두 로그란 무엇입니까? 

<details>
   <summary> 답안 보기 (👈 Click)</summary>
<br />

+ 리두 로그는 트랜잭션의 4가지 요소인 ACID 중에서 D에 해당하는 영속성과 가장 밀접하게 연관되어 있습니다. <br>
  리두 로그는 하드웨어나 소프트웨어 등 여러 가지 문제점으로 인해 MySQL 서버가 비정상적으로 종료됐을 때, <br>
  데이터 파일에 기록되지 못한 데이터를 잃지 않게 해주는 안전장치입니다. <br> 
  
</details>

-----------------------

### 리두 로그와 관련해서 ACID도 중요하지만 성능도 중요하기 때문에 어떤 것을 활용합니까? 

<details>
   <summary> 답안 보기 (👈 Click)</summary>
<br />

+ 리두 로그를 버퍼링할 수 있는 InnoDB 버퍼 풀이나 로그 버퍼와 같은 자료구조도 갖고 있습니다. 
  
</details>

-----------------------

### MySQL 서버가 비정상 종료되는 경우 InnoDB 스토리 엔진의 데이터 파일에는 
### 다음과 같은 두 가지 종류의 일관되지 않은 데이터가 존재할 수 있습니다.
### 1. 커밋됐지만 데이터 파일에 기록되지 않은 데이터
### 2. 롤백됐지만 데이터 파일에 이미 기록된 데이터 
### 각각의 경우에 어떻게 문제를 해결할 수 있습니까? 

<details>
   <summary> 답안 보기 (👈 Click)</summary>
<br />

+ 1번의 경우는 리두 로그에 저장된 데이터를 데이터 파일에 다시 복사하기만 하면 됩니다. <br>
  2번의 경우는 변경되기 전 데이터를 가진 언두 로그의 내용을 가져와 데이터 파일에 복사합니다. 
  
</details>

-----------------------

### 데이터베이스 서버에서 리두 로그와 관련해서 어떻게 시스템 변수를 설정해야 하는가?
### 이 때의 문제점은 무엇이고, 그것에 대한 해결책은 무엇인가? 

<details>
   <summary> 답안 보기 (👈 Click)</summary>
<br />

+ 리두 로그는 트랜잭션이 커밋되면 즉시 디스크로 기록되도록 시스템 변수를 설정해야 합니다. <br>
  하지만 이처럼 트랜잭션이 커밋될때마다 리두 로그를 디스크에 기록하도록 하는 작업은 많은 부하를 유발합니다.<br>
  따라서 InnoDB 스토리지 엔진에서 리두 로그를 어느 주기로 디스크에 동기화할지 결정하는 <br>
  innodb_flush_log_at_trx_commit 시스템 변수를 제공합니다. 
  
</details>

-----------------------
### InnoDB 어댑티브 해시 인덱스란 무엇인가요?

<details>
   <summary> 답안 보기 (👈 Click)</summary>
<br />

+ InnoDB 엔진에서 사용자가 자주 요청하는 데이터에 대해 자동으로 생성하는 인덱스이며, <br>
  사용자는 innodb_adaptive_hash_index 시스템 변수를 이용해서 어댑티브 해시 인덱스 기능을 <br>
  활성화하거나 비활성화할 수 있습니다. 
  
</details>

-----------------------
### InnoDB 어댑티브 해시 인덱스의 기능은 무엇인가요?

<details>
   <summary> 답안 보기 (👈 Click)</summary>
<br />

+ 어댑티브 해시 인덱스는 B-Tree 검색 시간을 줄여주기 위해 도입된 기능입니다. <br>
  InnoDB 스토리지 엔진은 자주 읽히는 데이터 페이지의 키 값을 이용해 해시 인덱스를 만들고, <br>
  필요할 때마다 어댑티브 해시 인덱스를 검색해서 레코드가 저장된 데이터 페이지를 즉시 찾아갈 수 있습니다. <br>
  B-Tree를 루트 노드부터 리프 노드까지 찾아가는 비용이 없어지고, <br>
  그만큼 CPU는 적은 일을 하지만 쿼리의 성능은 빨라집니다. <br> 
  
</details>

-----------------------
